Command Injection

PC에선 잘 발견 안되지만 리눅스 특성상 잘 발견됨

/tmp/abc.txt에 hello world를 append

fopen()
fseek()
fwrite()
fclose()

system("/echo hello world >> /tmp/abc.txt")

x Confluence
Rule 10(ENV)

Do not call system() 
exec(_) 

1. system(), exec() 함수를 호출하는 프로그램 식별
  1-1 system 문자열을 포함하고 있는 실행 파일 식별
	  $ find 펌웨어루트디렉토리 -executable -exec grep system {} \; 2>/dev/null
  1-2 식별된 실행 파일들을 대상으로 심볼을 조사
	  $ readelf -s 조사할프로그램 | grep system
	  ex) readelf -s 펌웨어루트/sbin/dhcpd | grep system) <- 특정 함수를 사용한다면, 그 함수에 symbolic link를 건다  
2. 함수에 전달되는 명령어 문자열이 동적으로 생성되는가?
system("echo 123")
system("echo 사용자입력값")
3. 동적으로 생성되는 명령어 문자열에 포함되는 사용자 입력값이 적절하게 필터링/sanitizing되는가?

